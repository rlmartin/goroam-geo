goroam.google.maps.version="2.176";if((goroam.browser.host_info().name==goroam.enm.browsers.safari)&&(goroam.browser.host_info().major_ver<525)){goroam.google.maps.version=""}if(goroam.google.maps.version!=""){google.load("maps",goroam.google.maps.version)}else{alert("<%= Constant::get(:error_header) %><%= Constant::get(:error_browser_not_supported) %>")}goroam.google.maps.__active_map=undefined;goroam.google.maps.__active_map_id="<%= @settings[:map] %>";goroam.google.maps.__count_of_page_lat_lng=0;goroam.google.maps.__count_of_processing_addr=0;goroam.google.maps.__page_maps={};goroam.google.maps.__addr_attr="<%= Constant::get(:addr_attribute) %>";goroam.google.maps.__lat_attr="<%= Constant::get(:lat_attribute) %>";goroam.google.maps.__lng_attr="<%= Constant::get(:lng_attribute) %>";goroam.google.maps.__map_attr="<%= Constant::get(:map_attribute) %>";google.__setOnLoadCallback=google.setOnLoadCallback;google.__onload_callback_functions=[];google.__onload_callback=function(B){for(var A=0;A<google.__onload_callback_functions.length;A++){google.__onload_callback_functions[A](B)}};google.__setOnLoadCallback(google.__onload_callback);google.setOnLoadCallback=function(A){google.__onload_callback_functions.add_if_new(A)};goroam.google.maps.extend_functionality=function(){google.maps.Map2.prototype.active_marker=undefined;google.maps.Map2.prototype.__bounds=undefined;google.maps.Map2.prototype.__lines=undefined;google.maps.Map2.prototype.add_lat_lng=function(F,G,D,A){var C=F+"_"+G;if(!this.__lat_lng){this.__lat_lng={}}if(this.__lat_lng[C]){}else{var B=new google.maps.LatLng(F,G);var E=goroam.google.maps.create_marker(B);this.__lat_lng[C]=E;this.addOverlay(this.__lat_lng[C]);this.get_bounds().extend(B)}D=(D||"").trim();A=(A||"").trim();if((D!="")&&(A!="")){var E=this.__lat_lng[C];if(!E.__menu){E.__menu=new goroam.google.maps.html_overlay({class_name:"<%= Constant::get(:css_prefix) %>point_menu",container:document.createElement("ul"),lat_lng:B,position:"se"});this.addOverlay(E.__menu);goroam.event.bind(E,"click",E,E.trigger_hide_menus);goroam.event.bind(E,"click",E.__menu.get_container(),goroam.dhtml.toggle_me);goroam.event.bind(this.getContainer(),"hide_menus",E,E.hide_menu)}var H=document.createElement("li");var I=document.createElement("a");I.href="#"+D;I.innerHTML=A;goroam.dhtml.edit_class_name(H,"point_menu_item");H.appendChild(I);E.__menu.get_container().appendChild(H);if((E.__menu.get_container().childNodes.length%2)==0){goroam.dhtml.edit_class_name(H,"odd_row")}}return this.__lat_lng[C]};google.maps.Map2.prototype.__addOverlay=google.maps.Map2.prototype.addOverlay;google.maps.Map2.prototype.addOverlay=function(A){this.__addOverlay(A);A.map=this};google.maps.Map2.prototype.__removeOverlay=google.maps.Map2.prototype.removeOverlay;google.maps.Map2.prototype.removeOverlay=function(A){this.__removeOverlay(A);A.map=undefined};google.maps.Map2.prototype.add_directions_line=function(A,C,E,D,B){goroam.google.maps.add_directions_line_to_map(this,A,C,E,D,B)};google.maps.Map2.prototype.add_point_to_line=function(A,B,D,G,C,F,E){goroam.google.maps.add_point_to_line(this,A,B,D,G,C,F,E)};google.maps.Map2.prototype.create_active_marker=function(B,A){B=(B||this.getCenter());this.active_marker=goroam.google.maps.create_marker(B,{draggable:true});this.addOverlay(this.active_marker);goroam.event.addListener(this.active_marker,"dragend",function(C){goroam.event.trigger(this.map,"location_found",C)})};google.maps.Map2.prototype.extend_bounds=function(A){this.get_bounds().extend(A);this.resize_to_bounds()};google.maps.Map2.prototype.get_bounds=function(){if(!this.__bounds){this.__bounds=new google.maps.LatLngBounds()}return this.__bounds};google.maps.Map2.prototype.get_line_array=function(){if(!this.__lines){this.__lines=[]}return this.__lines};google.maps.Map2.prototype.goto_location=function(A){goroam.google.maps.find_location(this,A,function(D,B,C){if(C&&C.ExtendedData&&C.ExtendedData.LatLonBox){this.recenter_active_marker(D,new google.maps.LatLngBounds(new google.maps.LatLng(C.ExtendedData.LatLonBox.south,C.ExtendedData.LatLonBox.west),new google.maps.LatLng(C.ExtendedData.LatLonBox.north,C.ExtendedData.LatLonBox.east)))}else{this.recenter_active_marker(D)}goroam.event.trigger(this,"location_found",D,B,C)})};google.maps.Map2.prototype.recenter_active_marker=function(A,B){if(this.active_marker){this.active_marker.setLatLng(A)}else{this.create_active_marker(A,false)}if(goroam.system.is_numeric(B)||(B==undefined)){this.setCenter(A,B)}else{this.resize_to_bounds(B)}};google.maps.Map2.prototype.recenter_active_marker_on_event=function(A){A=A.toLowerCase();if(A=="dblclick"){this.disableDoubleClickZoom()}google.maps.Event.addListener(this,A,function(C,B){this.recenter_active_marker(B)})};google.maps.Map2.prototype.resize_to_bounds=function(A){var C=false;A=(A||this.get_bounds());if(A&&!A.isEmpty()){var B=this.getBoundsZoomLevel(A);this.setCenter(A.getCenter(),B)}return C};google.maps.Map2.prototype.show_focus=function(A){if(!this.__focus_overlay){this.__focus_overlay=goroam.google.maps.create_focus_overlay(A);this.addOverlay(this.__focus_overlay)}else{if(this.__focus_overlay.map!=this){this.addOverlay(this.__focus_overlay)}this.__focus_overlay.setLatLng(A)}};google.maps.Map2.prototype.show_layer=function(A){if(!this.__layers){this.__layers={}}if(!this.__layers[A]){this.__layers[A]=new google.maps.Layer(A);this.addOverlay(this.__layers[A])}this.__layers[A].show()};google.maps.Map2.prototype.hide_layer=function(A){if(!this.__layers){this.__layers={}}if(this.__layers[A]){this.__layers[A].hide()}};google.maps.Marker.prototype.trigger_hide_menus=function(){if(this.map){goroam.event.trigger(this.map.getContainer(),"hide_menus",this)}};google.maps.Marker.prototype.hide_menu=function(A){if(this.__menu&&(this!=A)){goroam.dhtml.hide(this.__menu.get_container())}};goroam.google.maps.html_overlay=function(B){var A=this;if(B&&B.container){A.__container=B.container}else{A.__container=document.createElement("div")}goroam.dhtml.edit_class_name(A.__container,"<%= Constant::get(:css_prefix) %>html_overlay"+((B&&B.class_name)?" "+B.class_name:""),"",true);if(B&&B.lat_lng){A.__lat_lng=B.lat_lng}A.__position=(B&&B.position)?B.position:""};goroam.google.maps.html_overlay.prototype=new google.maps.Overlay();goroam.google.maps.html_overlay.prototype.copy=function(){var A=this;var B=new goroam.google.maps.html_overlay({container:A.__container.cloneNode(true),lat_lng:A.__lat_lng,position:A.__position});return B};goroam.google.maps.html_overlay.prototype.get_container=function(){return this.__container};goroam.google.maps.html_overlay.prototype.getLatLng=function(){return this.__lat_lng};goroam.google.maps.html_overlay.prototype.initialize=function(B){var A=this;A.__container.style.position="absolute";A.map=B;A.map.getPane(G_MAP_MARKER_PANE).appendChild(A.__container)};goroam.google.maps.html_overlay.prototype.setLatLng=function(B){var A=this;var C=false;if(B){A.__lat_lng=B;A.redraw(true);C=true}return C};goroam.google.maps.html_overlay.prototype.redraw=function(C){var A=this;if(!C||!(A.map)){return }var D=A.map.fromLatLngToDivPixel(A.__lat_lng);var B=new goroam.math.compass_position(A.__position);A.__container.style.left=B.get_left(D.x,A.__container.offsetWidth)+"px";A.__container.style.top=B.get_top(D.y,A.__container.offsetHeight)+"px"};goroam.google.maps.html_overlay.prototype.remove=function(){var A=this.__container;A.parentNode.removeChild(A)}};goroam.google.maps.add_directions_line_to_map=function(I,H,C,A,B,D){var G=H.getStatus();if(G&&G.code==200){var E=H.getPolyline();var F={};I.addOverlay(E);if(C){F.color=C}if(A){F.weight=A}if(B){F.opacity=B}E.setStrokeStyle(F)}else{if(!G||(G.code==500)){window.setTimeout(function(){goroam.google.maps.add_directions_line_to_map(I,H,C,A,B)},100)}else{if(G&&(G.code==620)){H.loadFromWaypoints(H._waypoints,{getPolyline:true,preserveViewport:true,travelMode:(D||G_TRAVEL_MODE_DRIVING)});window.setTimeout(function(){goroam.google.maps.add_directions_line_to_map(I,H,C,A,B)},100)}}}};goroam.google.maps.add_point_to_line=function(N,I,D,L,C,F,B,E){var J;C=((C||"")==""?"<%= @settings[:line_on_roads] %>":C);var M=false;switch(C){case"walking":case"driving":case"yes":M=true}F=(F||"<%= @settings[:line_color] %>");E=(E||parseFloat("<%= @settings[:line_opacity] %>"));B=(B||parseInt("<%= @settings[:line_width] %>"));if(D.getLatLng){D=D.getLatLng()}if(M){var K=false;J=N.get_line_array()[I];var G=0;if(J){G=(L?Math.floor(L/parseInt("<%= Constant::get(:follow_roads_max_per_line) %>")):J.length-1);if(J[G]&&J[G]._waypoints&&J[G]._waypoints.length==parseInt("<%= Constant::get(:follow_roads_max_per_line) %>")){G++}}else{J=[];N.get_line_array()[I]=J}if(!J[G]){J[G]=new google.maps.Directions(undefined,(C=="walking"?goroam.google.maps.get_hidden_directions_container(G):undefined));K=true}J=J[G];if(!J._waypoints){J._waypoints=[]}L=(L?L-(G*parseInt("<%= Constant::get(:follow_roads_max_per_line) %>"))+G:J._waypoints.length);if(L<0){L=0}if(G>0){if(L==0){var A=N.get_line_array()[I][G-1]._waypoints;J._waypoints[0]=A[A.length-1];L++}}J._waypoints[L]=D.toString();J.clear();var H=G_TRAVEL_MODE_DRIVING;if(C=="walking"){H=G_TRAVEL_MODE_WALKING}J._updated=true;window.setTimeout(function(){if(J._updated){J.loadFromWaypoints(J._waypoints,{getPolyline:true,preserveViewport:true,travelMode:H});J._updated=false}},parseInt("<%= Constant::get(:follow_roads_calc_delay) %>"));if(K){N.add_directions_line(J,F,B,E,H)}}else{J=N.get_line_array()[I];if(!J){J=new google.maps.Polyline([],F,B,E);N.addOverlay(J);N.get_line_array()[I]=J}L=(L||J.getVertexCount());J.insertVertex(L,D)}N.extend_bounds(D)};goroam.google.maps.create_focus_overlay=function(A){var B=new goroam.google.maps.html_overlay({lat_lng:A,class_name:"<%= Constant::get(:css_prefix) %>focus_overlay"});B.__redraw=B.redraw;B.redraw=function(D){var C=this;goroam.dhtml.edit_class_name(C.get_container(),"focus_overlay_stage1");C.__redraw(D);window.setTimeout(function(){goroam.dhtml.edit_class_name(C.get_container(),"focus_overlay_stage2","focus_overlay_stage1");C.__redraw(D);window.setTimeout(function(){goroam.dhtml.edit_class_name(C.get_container(),"focus_overlay_stage3","focus_overlay_stage2");C.__redraw(D);window.setTimeout(function(){goroam.dhtml.edit_class_name(C.get_container(),"","focus_overlay_stage3");C.__redraw(D);C.map.removeOverlay(C)},parseInt("<%= Constant::get(:focus_overlay_interval) %>"))},parseInt("<%= Constant::get(:focus_overlay_interval) %>"))},parseInt("<%= Constant::get(:focus_overlay_interval) %>"))};return B};goroam.google.maps.create_marker=function(B,C){var A=false;if(C&&C.draggable){A=C.draggable}if(!C){C={}}C.draggable=true;C.icon=goroam.google.maps.create_stock_icon("<%= @settings[:marker_icon] %>");var D=new google.maps.Marker(B,C);if(!A){D.disableDragging()}return D};goroam.google.maps.create_icon=function(C,B){var D=new google.maps.Icon();B=(B||"");for(var A in C){switch(A){case"image":case"printImage":case"printShadow":case"shadow":case"transparent":D[A]=B+C[A];break;default:D[A]=C[A]}}return D};goroam.google.maps.create_stock_icon=function(A){A=(A||goroam.enm.icons.pushpin.orange).toLowerCase();var B="<%= Constant::get(:root_url) %>/images/icons/markers/";var C,D;switch(A){case goroam.enm.icons.pushpin.blue:case goroam.enm.icons.pushpin.green:case goroam.enm.icons.pushpin.orange:case goroam.enm.icons.pushpin.red:C={iconAnchor:new google.maps.Point(9,32),iconSize:new google.maps.Size(32,32),image:"red_pushpin.png",imageMap:[9,32,10,29,11,25,5,16,10,12,14,6,12,2,14,0,18,0,26,6,21,15,23,18,23,22,20,24,14,25,11,32],infoWindowAnchor:new google.maps.Point(9,32),printImage:"red_pushpin.gif",printShadow:"pushpin_shadow.gif",shadow:"pushpin_shadow.png",shadowSize:new google.maps.Size(59,32),transparent:"pushpin_transparent.png"};switch(A){case goroam.enm.icons.pushpin.blue:C.image="blue_pushpin.png";C.printImage="blue_pushpin.gif";break;case goroam.enm.icons.pushpin.green:C.image="green_pushpin.png";C.printImage="green_pushpin.gif";break;case goroam.enm.icons.pushpin.orange:C.image="orange_pushpin.png";C.printImage="orange_pushpin.gif";break}break;case goroam.enm.icons.goroam:C={iconAnchor:new google.maps.Point(8,40),iconSize:new google.maps.Size(34,40),image:"goroam.png",imageMap:[8,40,5,31,0,22,0,15,4,8,8,4,26,0,34,0,34,7,31,9,34,13,34,24,26,32,16,35,11,40],infoWindowAnchor:new google.maps.Point(8,40),printImage:"goroam.gif",printShadow:"goroam_shadow.gif",shadow:"goroam_shadow.png",shadowSize:new google.maps.Size(55,40),transparent:"goroam_transparent.png"};break}if(C){D=goroam.google.maps.create_icon(C,B)}return D};goroam.google.maps.find_location=function(A,E,D,C){var F=function(J){var I,G,H;if((J)&&(J.Status)){if(J.Status.code==500){goroam.google.maps.find_location(A,E,D)}else{if((J)&&(J.Placemark)){if((J.Placemark.length)&&(J.Placemark.length>0)){H=J.Placemark[0];I=H.Point;G=H.address}else{if(J.Placemark.Point){H=J.Placemark;I=H.Point;G=H.address}}if((I)&&(I.coordinates)&&(I.coordinates.length>=2)){I=new google.maps.LatLng(I.coordinates[1],I.coordinates[0])}else{I=undefined;G=undefined;H=undefined}}if(I){if(D){D.call(A,I,G,H)}}else{if(C){C()}else{alert("<%= Constant::get(:location_not_found) %>"+E)}}}}};var B=new google.maps.ClientGeocoder();B.getLocations(E,F)};goroam.google.maps.get_address=function(B,C){var D=function(H){var G;if(H&&H.Placemark&&(H.Placemark.length>0)){var F=[];for(var E=0;E<H.Placemark.length;E++){F[H.Placemark[E].AddressDetails.Accuracy]=H.Placemark[E]}if(F.length>0){G=F[F.length-1]}}else{if(H&&H.Placemark){G=H.Placemark}}if(G){if(C){C.call(null,G.address,G)}}else{alert("<%= Constant::get(:address_for_geo_point_not_found) %>")}};var A=new google.maps.ClientGeocoder();A.getLocations(B,D)};goroam.google.maps.get_hidden_directions_container=function(A){A=(A||0);if(!goroam.google.maps.__hidden_directions_container){goroam.google.maps.__hidden_directions_container=[]}if(!goroam.google.maps.__hidden_directions_container[A]){goroam.google.maps.__hidden_directions_container[A]=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(goroam.google.maps.__hidden_directions_container[A])}return goroam.google.maps.__hidden_directions_container[A]};goroam.google.maps.get_map=function(A){if(A&&(A!="")){goroam.google.maps.load_map_from_settings(A)}return(goroam.google.maps.__page_maps[A]||goroam.google.maps.__active_map)};goroam.google.maps.load=function(A){if(google.maps.BrowserIsCompatible()){goroam.google.maps.extend_functionality();goroam.event.addDomListener(window,"unload",goroam.google.maps.unload);if(A){A()}}else{alert("<%= Constant::get(:error_header) %><%= Constant::get(:error_browser_not_supported) %>")}};goroam.google.maps.load_active_map=function(){if(goroam.google.maps.load_map_from_settings(goroam.google.maps.__active_map_id)){goroam.google.maps.__active_map=goroam.google.maps.__page_maps[goroam.google.maps.__active_map_id]}};goroam.google.maps.load_from_page=function(){goroam.google.maps.load_active_map();var A=goroam.dhtml.get_elements_with_attribute(goroam.google.maps.__lat_attr+" , "+goroam.google.maps.__addr_attr);for(var B=0;B<A.length;B++){if(((A[B].getAttribute(goroam.google.maps.__lat_attr)||"")=="")||((A[B].getAttribute(goroam.google.maps.__lng_attr)||"")=="")){goroam.google.maps.find_location(A[B],A[B].getAttribute(goroam.google.maps.__addr_attr),function(E,C,D){if(E){this.setAttribute(goroam.google.maps.__lat_attr,E.lat());this.setAttribute(goroam.google.maps.__lng_attr,E.lng());goroam.google.maps.process_geotagged_element(this)}goroam.google.maps.__count_of_processing_addr--;if(goroam.google.maps.__count_of_processing_addr<=0){goroam.google.maps.process_all_geolists()}},function(){goroam.google.maps.__count_of_processing_addr--;if(goroam.google.maps.__count_of_processing_addr<=0){goroam.google.maps.process_all_geolists()}});goroam.google.maps.__count_of_processing_addr++}else{goroam.google.maps.process_geotagged_element(A[B])}}if(goroam.google.maps.__count_of_processing_addr<=0){goroam.google.maps.process_all_geolists()}};goroam.google.maps.load_map_from_settings=function(F){var E=false;var D=document.getElementById(F);if(D&&!goroam.google.maps.__page_maps[F]){var B=document.createElement("a");B.name=F;D.insertBefore(B,D.firstChild);var A=new google.maps.Map2(D);A.setCenter(new google.maps.LatLng("<%= @settings[:lat] %>","<%= @settings[:lng] %>"),parseInt("<%= @settings[:zoom] %>"));try{switch("<%= @settings[:controls] %>"){case"all":A.addControl(new GLargeMapControl());A.addControl(new GMapTypeControl());A.addControl(new GOverviewMapControl());A.addControl(new GScaleControl());break;case"all_small":A.addControl(new GSmallMapControl());A.addControl(new GMenuMapTypeControl());A.addControl(new GOverviewMapControl());A.addControl(new GScaleControl());break;case"min":A.addControl(new GMenuMapTypeControl());A.addControl(new GSmallZoomControl());break;case"none":break}}catch(C){A.addControl(new GSmallMapControl());A.addControl(new GMapTypeControl())}goroam.google.maps.__page_maps[F]=A;E=true}return E};goroam.google.maps.add_map_prompt=function(B){if(!B.__map_prompt){var E="<%= @settings[:position] %>";var F="";if(E.left(4)=="out_"){F="_"+E;E=E.right(2)}goroam.event.bindDom(B,"mouseover",B,goroam.dhtml.set_mouseover);goroam.event.bindDom(B,"mouseover",B,goroam.google.maps.over_map_element);goroam.event.bindDom(B,"mouseout",B,goroam.dhtml.unset_mouseover);goroam.event.bindDom(B,"mouseout",B,goroam.google.maps.leave_map_element);goroam.event.bindDom(B,"click",B,function(G){if(this.__map_prompt&&this.__map_prompt.__mouseover){goroam.dhtml.cancel_bubble(G)}});var D=document.createElement("a");D.style.position="absolute";D.name="_latlng"+goroam.google.maps.__count_of_page_lat_lng++;D.id=D.name;if(goroam.browser.host_info().name==goroam.enm.browsers.ie){D.innerHTML="&nbsp;"}var C=document.createElement("a");C.href="#"+goroam.system.set_default(B.getAttribute(goroam.google.maps.__map_attr),"<%= @settings[:map] %>");C.innerHTML='<img src="<%= Constant::get(:root_url) %>/images/px.gif" style="border-width:0px; height:100%; width:100%;" title="<%= Constant::get(:show_on_map_prompt_text) %>" />';B.__map_prompt=document.createElement("div");B.__map_prompt.__anchor=D.name;B.__map_prompt.className="<%= Constant::get(:css_prefix) %>map_prompt <%= Constant::get(:css_prefix) %>map_prompt_"+E;B.__map_prompt.appendChild(C);B.__map_prompt.__mouseover_class_name="map_prompt_hover";B.__map_prompt.__mouseout_class_name="map_prompt_hover_element";goroam.event.bindDom(C,"click",B,goroam.google.maps.show_on_map);goroam.event.bindDom(B.__map_prompt,"mouseover",B.__map_prompt,goroam.dhtml.set_mouseover);goroam.event.bindDom(B.__map_prompt,"mouseout",B.__map_prompt,goroam.dhtml.unset_mouseover);goroam.event.bindDom(B.__map_prompt,"mouseout",B,goroam.google.maps.leave_map_element);if(B.style.position!="absolute"){B.style.position="relative"}if(B.tagName.toLowerCase()=="img"){var A=document.createElement("span");A.style.position=B.style.position;B.style.position="relative";A.style.top=B.style.top;A.style.bottom=B.style.bottom;A.style.left=B.style.left;A.style.right=B.style.right;A.className="<%= Constant::get(:css_prefix) %>img_container";if(goroam.browser.host_info().name==goroam.enm.browsers.ie){A.style.zoom=1}B.style.top="";B.style.bottom="";B.style.left="";B.style.right="";B.parentNode.replaceChild(A,B);A.appendChild(B);A.appendChild(B.__map_prompt);A.insertBefore(D,B)}else{if((goroam.browser.host_info().name==goroam.enm.browsers.ie)&&B.currentStyle&&!B.currentStyle.hasLayout){B.style.zoom=1}B.appendChild(B.__map_prompt);goroam.dhtml.edit_class_name(B,"tagged_element"+F);B.parentNode.insertBefore(D,B)}}return B.__map_prompt.__anchor};goroam.google.maps.over_map_element=function(){if(!this.__map_prompt.__mouseover){goroam.dhtml.edit_class_name(this.__map_prompt,"map_prompt_hover_element")}};goroam.google.maps.leave_map_element=function(){var A=this;window.setTimeout(function(){if(!A.__mouseover&&!A.__map_prompt.__mouseover){goroam.dhtml.edit_class_name(A.__map_prompt,"","map_prompt_hover_element")}},parseInt("<%= Constant::get(:exit_hover_timeout) %>"))};goroam.google.maps.process_all_geolists=function(){var D=["ul","ol"];for(var A=0;A<D.length;A++){var C=document.getElementsByTagName(D[A]);for(var B=0;B<C.length;B++){goroam.google.maps.process_geolist(C[B])}}};goroam.google.maps.process_geolist=function(H){var B={};if((H.tagName.toLowerCase()=="ul")||(H.tagName.toLowerCase()=="ol")){if(goroam.dhtml.get_inner_text(H).compress_whitespace().trim()==""){goroam.dhtml.edit_class_name(H,"map_route")}var C=(H.className.match(/\b(gr_)?map_route_(walking|driving)\b/i)||[""])[0].right_of("map_route_").toLowerCase();var K=goroam.dhtml.get_elements_with_attribute(goroam.google.maps.__lat_attr+" , "+goroam.google.maps.__addr_attr,H);if(K.length>0){goroam.dhtml.edit_class_name(H,"geo_list");var J=(H.id||"");var E=H.style.color;var A=parseInt(H.style.width);var D=H.style.opacity;if(J==""){H.id=goroam.math.random_string(30)}for(var F=0;F<K.length;F++){var L=goroam.google.maps.get_map(K[F].getAttribute(goroam.google.maps.__map_attr));if(L){var I=L.getContainer().id;if(B[I]){B[I]++}else{B[I]=0}if(((K[F].getAttribute(goroam.google.maps.__lat_attr)||"")=="")||((K[F].getAttribute(goroam.google.maps.__lng_attr)||"")=="")){var G=B[I];goroam.google.maps.find_location(K[F],K[F].getAttribute(goroam.google.maps.__addr_attr),function(O,M,N){if(O){this.setAttribute(goroam.google.maps.__lat_attr,O.lat());this.setAttribute(goroam.google.maps.__lng_attr,O.lng());L.add_point_to_line(J,O,G,C,E,A,D)}},true)}else{L.add_point_to_line(J,new google.maps.LatLng(K[F].getAttribute(goroam.google.maps.__lat_attr),K[F].getAttribute(goroam.google.maps.__lng_attr)),B[I],C,E,A,D)}if(K[F].tagName.toLowerCase()=="li"){goroam.dhtml.edit_class_name(K[F],"geo_tag_only")}}}}}};goroam.google.maps.process_geotagged_element=function(D){var C=true;if(D.tagName.toLowerCase()=="li"){var B=goroam.dhtml.get_inner_text(D);if((B.title==""||B.title==null)&&(B.value==""||B.value==null)){C=false}}if(C){var F="";if((D.tagName.toLowerCase()=="img")||(goroam.dhtml.get_inner_text(D)!="")){F=goroam.google.maps.add_map_prompt(D)}var A=goroam.google.maps.get_map(D.getAttribute(goroam.google.maps.__map_attr));if(A){var B=goroam.dhtml.get_element_data(D);var G=(B.title||"");if(G==""){G=(B.value||"")}if(G.length>25){G=G.left(25)+"..."}var E=A.add_lat_lng(D.getAttribute(goroam.google.maps.__lat_attr),D.getAttribute(goroam.google.maps.__lng_attr),F,G);goroam.event.bind(E,"mouseover",D,goroam.dhtml.highlight);goroam.event.bind(E,"mouseout",D,goroam.dhtml.unhighlight);if(E.__menu){goroam.event.bindDom(E.__menu.get_container().lastChild,"mouseover",D,goroam.dhtml.highlight);goroam.event.bindDom(E.__menu.get_container().lastChild,"mouseout",D,goroam.dhtml.unhighlight)}A.resize_to_bounds()}}goroam.xdcomm.send_element(D)};goroam.google.maps.show_on_map=function(F){var E=false;var B=('<%= @settings[:popup] == nil ? "false" : "true" %>'=="true"?true:false);var H=('<%= @settings[:popup_window] == nil ? "false" : "true" %>'=="true"?true:false);var D=(this.getAttribute(goroam.google.maps.__map_attr)||goroam.google.maps.__active_map_id);var A=goroam.google.maps.get_map(D);if(A&&!(B||H)){var C=new google.maps.LatLng(this.getAttribute(goroam.google.maps.__lat_attr),this.getAttribute(goroam.google.maps.__lng_attr));A.setCenter(C);A.show_focus(C);E=true}else{if(H){goroam.dhtml.cancel_bubble(F);var G=goroam.controls.popup_window("<%= Constant::get(:root_url) %>/"+this.getAttribute(goroam.google.maps.__lat_attr)+"/"+this.getAttribute(goroam.google.maps.__lng_attr)+"?layout=min&find="+goroam.dhtml.get_element_data(this).value,482,620,D,false,true);G.focus()}else{goroam.controls.popup_map(new google.maps.LatLng(this.getAttribute(goroam.google.maps.__lat_attr),this.getAttribute(goroam.google.maps.__lng_attr)));goroam.dhtml.cancel_bubble(F)}}return E};goroam.google.maps.unload=function(){google.maps.Unload()}